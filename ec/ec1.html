<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>EC page</title>
  <link href="../style.css" rel="stylesheet" type="text/css" />
  <!--   Load script first so that containerId is available. -->
  <script src="script.js"></script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-593490366"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'AW-593490366', {'allow_enhanced_conversions': true});
  </script>

  <script>
    function setUserData() {
      gtag('set', 'user_data', {
        "email": document.getElementById("email").value,
        "phone_number": document.getElementById("phone").value,
        "first_name": document.getElementById("firstName").value,
        "last_name": document.getElementById("lastName").value,
        "address": document.getElementById("address").value,
        "zip": document.getElementById("zip").value,
        "country": document.getElementById("country").value,
      });
    }


    function sendConversion(url) {
      var callback = function () {
        if (typeof (url) != 'undefined') {
          window.location = url;
        }
      };
      gtag('event', 'conversion', {
        'send_to': document.getElementById('sendTo').value,
        'transaction_id': '',
        'event_callback': callback
      });
      return false;
    }
  </script>

</head>

<body>
  <h2>EC page1</h2>

  <br />
  <br />

  <div>
    <h4>EC Form</h4>
    <pre>
      You need to load ads tag or GTE tag with Ads destination to get "em" param
      <code>
        gtag('config','AW-593490366')
      </code>

    </pre>

    <div>
      <h2>Conversion "send_to":</h2>
      <input value="AW-593490366/1oSdCITqtbMDEL7j_5oC" id="sendTo" style="width: 500px;">
    </div>

    <form>
      <div class="page-item page-form">
        <div class="form-item">
          <h3>User data</h3>
        </div>
        <div>
          <label>
            First name:
          </label>
          <input id="firstName" class="fn" type="text" value="foo" />
        </div>
        <div>
          <label>
            Last name:
          </label>
          <input id="lastName" class="ln" type="text" value="bar" />
        </div>
        <div>
          <label>
            Email:
          </label>
          <input id="email" class="email" type="email" value="test@123.com" />
        </div>
        <div>
          <label>
            Phone:
          </label>
          <input id="phone" type="phone" class="pn" value="+12345678900" />
        </div>
        <div>
          <label>
            Address:
          </label>
          <input id="address" type="text" class="address" value="93 Awesome, Mont, CA" />
        </div>
        <div>
          <label>
            Country:
          </label>
          <input id="country" type="text" class="country" value="USA" />
        </div>
        <div>
          <label>
            Zip:
          </label>
          <input id="zip" type="text" class="zip" value="95455" />
        </div>
        <div class="form-footer">
          <button onclick="setUserData()" type="button">Manual gtag(set) user data</button>
        </div>
        <div>
          <button type="button" onclick="sendConversion()">Send conversion event</button>
        </div>


        <div>
          <button type="submit" onclick="sendConversion()">Send conversion with form submit</button>
        </div>
      </div>
    </form>
  </div>

  <br />
  <br />


</body>

</html>